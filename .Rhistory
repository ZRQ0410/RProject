model.hyper2 <- glm(hypnonhyp ~ smoking, binomial)
summary(model.hyper2)
a = -1.49611 # significant, p < 2e-16
# if b is significant:
# baseline odds:
exp(a)
# odds ratio:
exp(b)
# odds of exposure(smokers):
exp(a+b)
# prob of hypertension in non-smokers:
exp(a)/(exp(a)+1)
# prob of hypertension in smokers:
exp(a+b)/(exp(a+b)+1)
# prob of hypertension in non-smokers:
exp(a)/(exp(a)+1)
# odds of exposure(smokers):
exp(a+b)
# prob of hypertension in smokers:
exp(a+b)/(exp(a+b)+1)
load("C:/Users/12927/Desktop/RLectures/10LogisticReg/Workspace, Lecture 10.RData")
load("C:/Users/12927/Desktop/RLectures/10LogisticReg/Workspace, Lecture 10.RData")
smoking <- gl(2,1,4, noyes)
# hypertension analysis
# files hypertension and hypnonhyp
noyes = c("no", "yes")
smoking <- gl(2,1,4, noyes)
smoking
obesity <- gl(2,2,4, noyes)
obesity
smoking <- gl(2,1,6, noyes)
smoking
smoking
# hypertension analysis
# files hypertension and hypnonhyp
noyes = c("no", "yes")
smoking <- gl(2,1,5, noyes)
smoking
smoking <- gl(2,1,4, noyes)
smoking
obesity <- gl(2,2,4, noyes)
obesity
total <- c(247, 102, 59, 25)
total
View(hypertension)
hypertension <- data.frame(smoking, obesity,total,hyper)
# create data frame hypertension
noyes = c("no", "yes")
smoking <- gl(2,1,4, noyes)
obesity <- gl(2,2,4, noyes)
total <- c(247, 102, 59, 25)
hyper <- c(40,15,16,8)
hypertension <- data.frame(smoking, obesity,total,hyper)
hypnonhyp <- cbind(hyper, nonhyper=total-hyper)
hypnonhyp
# model 1
model.hyper <- glm(hypnonhyp ~ obesity, family = binomial)
summary(model.hyper)
# model 2
model.hyper2 <- glm(hypnonhyp ~ smoking, binomial)
summary(model.hyper2)
# prob of hypertension in smokers:
exp(a+b)/(exp(a+b)+1)
a = -1.49611 # significant, p < 2e-16
b = -0.01279 # not significant, p = 0.963
# if b is significant:
# baseline odds:
exp(a)
# odds ratio:
exp(b)
# odds of exposure(smokers):
exp(a+b)
# prob of hypertension in non-smokers:
exp(a)/(exp(a)+1)
# prob of hypertension in smokers:
exp(a+b)/(exp(a+b)+1)
menarche
load("C:/Users/12927/Desktop/RLectures/Workspace, Lecture 11.RData")
summary(menar)
View(menar)
# model 2
model.hyper2 <- glm(hypnonhyp ~ smoking, family = binomial)
summary(model.hyper2)
# model 2
model.hyper2 <- glm(hypnonhyp ~ smoking, family = binomial)
# model 2
model.hyper2 <- glm(hypnonhyp ~ smoking, family = binomial)
# model 2
model.hyper2 <- glm(hypertension$hypnonhyp ~ hypertension$smoking, family = binomial)
# menarche analysis
# model menarche
model.menar <- glm(menarche~age,binomial, data=menar)
summary(model.menar)
# logits
predict(model.menar, type="response")
# probabilities
probs <- predict(model.menar, type="response")
probs
# logits
predict(model.menar, type="response")
# logits
predict(model.menar, type="response")
# probabilities
probs <- predict(model.menar, type="response")
probs
# logits
predict(model.menar, type="response")
probs
# probability plot
plot(probs~age, data=menar, ylab="menarche", pch=16)
# logits
predict(model.menar)
# logits
predict(model.menar, type="response")
# logits
predict(model.menar)
exp(9.95323975)/(exp(9.95323975)+1)
# probability plot
plot(probs~age, data=menar, ylab="menarche", pch=16)
# factors with >2 levels
model.infant <- glm(healthy ~ month,binomial, data=infant)
predict(model.menar, data.frame(age=10), type= "response")
predict(model.menar, data.frame(age=15), type= "response")
predict(model.menar, data.frame(age=20), type= "response")
predict(model.menar, data.frame(age=13.19), type= "response")
predict(model.menar, data.frame(age=13.20), type= "response")
igf1
View(evans)
View(menar)
summary(menar2)
summary(model.menar2)
model.menar2 <- glm(igf1~menarche,binomial, data=menar)
summary(model.menar2)
#menar2 <- menar[complete.cases(lifehistory),]
model.menar2 <- glm(igf1~menarche,binomial, data=menar)
menar2 <- menar[complete.cases(menar$igf1),]
model.menar2 <- glm(igf1~menarche,binomial, data=menar)
View(menar2)
View(menar)
# menar2 <- menar[complete.cases(menar$igf1),]
model.menar2 <- glm(menarche~igf1,binomial, data=menar)
summary(model.menar2)
load("C:/Users/12927/Desktop/RLectures/Workspace, Lecture 11.RData")
# menar2 <- menar[complete.cases(menar$igf1),]
model.menar2 <- glm(menarche~igf1,binomial, data=menar)
summary(model.menar2)
predict(model.menar2, data.frame(igf1=500), type= "response")
# logit
-3.239609 + 0.008647 * 500
exp(logit) / (exp(logit)+1)
# logit
logit = -3.239609 + 0.008647 * 500
exp(logit) / (exp(logit)+1)
predict(model.menar2, data.frame(igf1=500), type= "response")
# model 2
model.hyper2 <- glm(hypnonhyp ~ smoking, family=binomial, data=hypertension)
summary(model.hyper2)
# 95% CI
confint(model.hyper2)
# odds ratios, probabilities
coef(model.hyper2)
exp(cbind('Odds ratio'=coef(model.hyper2), confint(model.hyper2)))
### another way:
# model 2
model.hyper2 <- glm(hypnonhyp ~ smoking, family=binomial, data=hypertension)
summary(model.hyper2)
# 95% CI
confint(model.hyper2)
confint.default(model.hyper2)
# odds ratios, probabilities
coef(model.hyper2)
exp(cbind('Odds ratio'=coef(model.hyper2), confint(model.hyper2)))
coef(model.hyper2)
exp(coef(model.hyper2))
0.224*0.987294
0.224*0.987294
coef(model.hyper2)
exp(coef(model.hyper2))
# odds ratios, probabilities
coef(model.hyper2)
exp(cbind('Odds ratio'=coef(model.hyper2), confint(model.hyper2)))
coef(model.hyper2)
exp(coef(model.hyper2))
0.224*0.987294
# predict probability at a given point
predict(model.menar, data.frame(age=20), type= "response")
# menarche analysis
# model menarche
model.menar <- glm(menarche ~ age,binomial, data=menar)
summary(model.menar)
# logits
predict(model.menar)
# probabilities
probs <- predict(model.menar, type="response")
probs
# probability plot
plot(probs ~ age, data=menar, ylab="menarche", pch=16)
# predict probability at a given point
predict(model.menar, data.frame(age=20), type= "response")
load("C:/Users/12927/Desktop/RLectures/Workspace, Lecture 11.RData")
# menarche ~ igf1
model.igf <- glm(menarche ~ igf1,binomial, data=menar)
summary(model.igf)
a = -3.239609
b = 0.008647
# logit
logit = -3.239609 + 0.008647 * 500
# prob
exp(logit) / (exp(logit)+1)
predict(model.igf, data.frame(igf1=500), type= "response")
exp(logit)
logit
exp(b)
View(menar)
exp(-3.239609)
0.03917921/(0.03917921+1)
predict(model.igf, data.frame(igf1=500), type= "response")
# prob
exp(logit)/(exp(logit)+1)
plot(predict(model.igf, type="response") ~ age, data=menar, pch=16)
plot(predict(model.igf, type="response") ~ menarche, data=menar, pch=16)
a = predict(model.igf, type="response")
a
plot(a ~ menarche, data=menar, pch=16)
plot(menarche ~ a, data=menar, pch=16)
a = predict(model.igf, type="response")
plot(menarche ~ a, data=menar, pch=16)
menarComplete <- menar[complete.cases(menar$igf1),]
a = predict(model.igf, type="response")
plot(menarche ~ a, data=menarComplete, pch=16)
plot(a ~ igf1, data=menarComplete, pch=16)
# delete NAs in igf1, then plot the prob
menarComplete <- menar[complete.cases(menar$igf1),]
probigf <- predict(model.igf, type="response")
plot(probigf ~ igf1, data=menarComplete, pch=16)
# factors with >2 levels
model.infant <- glm(healthy ~ month,binomial, data=infant)
View(infant)
# factors with >2 levels
# levels, not continuous, so make sure they are factors (month)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
coef(model.infant)
exp(coef(model.infant))
levels(infant$month)
infant$month <- relevel(infant$month, ref = 1)
View(infant)
load("C:/Users/12927/Desktop/RLectures/09PCA/Workspace, Lecture 9.RData")
load("C:/Users/12927/Desktop/RLectures/Workspace, Lecture 11.RData")
load("C:/Users/12927/Desktop/RLectures/Workspace, Lecture 11.RData")
0.2775735*0.1125828
# factors with >2 levels
# levels, not continuous, so make sure they are factors (month)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
coef(model.infant)
exp(coef(model.infant))
levels(infant$month)
summary(model.infant)
infant$month <- relevel(infant$month, ref = 1)
summary(model.infant)
infant$month <- relevel(infant$month, ref = 4)
summary(model.infant)
infant$month <- relevel(infant$month, ref = 4)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
levels(infant$month)
infant$month <- relevel(infant$month, ref = 3)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
infant$month <- relevel(infant$month, ref = 5)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
infant$month <- relevel(infant$month, ref = 1)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
load("C:/Users/12927/Desktop/RLectures/Workspace, Lecture 11.RData")
# factors with >2 levels
# levels, not continuous, so make sure they are factors (month)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
coef(model.infant)
exp(coef(model.infant))
levels(infant$month)
infant$month <- relevel(infant$month, ref = 4)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
levels(infant$month)
summary(model.infant)
load("C:/Users/12927/Desktop/RLectures/Workspace, Lecture 11.RData")
# factors with >2 levels
# levels, not continuous, so make sure they are factors (month)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
coef(model.infant)
exp(-0.81166578)/exp(-0.81166578)
exp(-1.123e-15)
exp(-1.25635160)/exp(-0.81166578)
# set April as baseline
infant$month <- relevel(infant$month, ref = 4)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
exp(-4.447e-01)
load("C:/Users/12927/Desktop/RLectures/Workspace, Lecture 11.RData")
# factors with >2 levels
# levels, not continuous, so make sure they are factors (month)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
coef(model.infant)
# factors with >2 levels
# levels, not continuous, so make sure they are factors (month)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
exp(-1.14814)/exp(-0.81167)
# set April as baseline
infant$month <- relevel(infant$month, ref = 4)
model.infant <- glm(healthy ~ month,binomial, data=infant)
summary(model.infant)
exp(-3.365e-01)
load("C:/Users/12927/Desktop/RLectures/Workspace, Lecture 11.RData")
View(evans)
# interactions
model.chd <- glm(chd~age*cat*chl,binomial, data=evans)
# interactions
model.chd <- glm(chd~age*cat*chl,binomial, data=evans)
summary(model.chd)
# model optimisation
model.menar2 <- glm(menarche~age*igf1,binomial, data=menar)
summary(model.menar2)
step(model.menar2)
summary(step(model.menar2))
# model optimisation
model.menar2 <- glm(menarche~age*igf1,binomial, data=menar)
summary(model.menar2)
step(model.menar2)
summary(step(model.menar2))
step(model.menar2)
summary(step(model.menar2))
# model optimisation
model.menar2 <- glm(menarche~age*igf1,binomial, data=menar)
summary(model.menar2)
step(model.menar2)
summary(step(model.menar2))
# model optimisation
model.menar2 <- glm(menarche~age*igf1,binomial, data=menar)
summary(model.menar2)
summary(step(model.menar2))
model.chd2 <- glm(chd~age*cat,binomial, data=evans)
summary(model.chd2)
summary(step(model.chd2))
# interactions
model.chd <- glm(chd~age*cat*chl,binomial, data=evans)
summary(model.chd)
# model optimisation
model.menar2 <- glm(menarche ~ age*igf1,binomial, data=menar)
summary(model.menar2)
step(model.menar2)
# model optimisation
model.menar2 <- glm(menarche ~ age*igf1,binomial, data=menar)
summary(model.menar2)
summary(step(model.menar2))
model.igf <- glm(menarche ~ igf1, binomial, data=menar)
summary(model.igf)
1/(1+exp(-1.0935))
probsigf <- predict(model.igf, type="response")
1/(1+exp(-1.0935))
predict(model.igf, data.frame(igf1 = 500), type= "response")
exp(-1.0935)/(1+exp(-1.0935))
model.igf <- glm(menarche ~ igf1, binomial, data=menar)
summary(model.igf)
predict(model.igf, data.frame(igf1 = 500), type="response")
-3.23+0.008647*500
# logit
logit = -3.239609 + 0.008647 * 500
-3.23+0.008647*500
exp(1.0935)/(exp(-1.0935)+1)
exp(1.0935)/(exp(1.0935)+1)
1/(1+exp(-1.0935))
predict(model.igf, data.frame(igf1 = 500), type="response")
# prob
exp(logit)/(exp(logit)+1)
predict(model.igf, data.frame(igf1=500), type= "response")
PASS
library(ISwR)
PASS
library(PASS)
library(MASS)
bacteria
bacteria
d <- subset(bacteria, ap == "a")
View(d)
p <- sub(bacteria, ap == "p")
p <- subset(bacteria, ap == "p")
View(p)
summary(d)
summary(bacteria)
124+96
prop.test(124, 220, 0.5)
prop.test(96, 220, 0.5)
a <- bacteria
View(a)
View(a)
table(bacteria$y, bacteria$trt)
table(bacteria$ID, bacteria$trt)
table(bacteria$hilo, bacteria$trt)
table(bacteria$y, bacteria$trt)
anorexia
hist(anorexia$Treat)
cont = subset(anorexia, treat=="Cont")
cbt = subset(anorexia, treat=="CBT")
ft = subset(anorexia, treat=="FT")
cont = subset(anorexia, Treat=="Cont")
cbt = subset(anorexia, Treat=="CBT")
ft = subset(anorexia, Treat=="FT")
View(cbt)
hist(cont$Prewt)
table(cont$Prewt)
summary(cont$Prewt)
View(cbt)
anorexia
wilcox.test(cont$Postwt, cont$Prewt, paired=T, conf.int=T)
wilcox.test(cbt$Postwt, cbt$Prewt, paired=T, conf.int=T)
wilcox.test(ft$Postwt, ft$Prewt, paired=T, conf.int=T)
wilcox.test(cont$Postwt, cont$Prewt, paired=T, conf.int=T)
wilcox.test(cbt$Postwt, cbt$Prewt, paired=T, conf.int=T)
wilcox.test(ft$Postwt, ft$Prewt, paired=T, conf.int=T)
wilcox.test(cont$Postwt, cont$Prewt, paired=T, conf.int=T)
wilcox.test(cbt$Postwt, cbt$Prewt, paired=T, conf.int=T)
birthwt
birthwt = birthwt
View(birthwt)
birthreg <- lm(birthwt$bwt ~ birthwt$lwt)
summary(brainreg)
summary(birthreg)
birthreg <- lm(birthwt$bwt ~ birthwt$lwt)
summary(birthreg)
plot(birthwt$bwt ~ birthwt$lwt)
abline(brainreg)
plot(birthwt$bwt ~ birthwt$lwt)
abline(birthreg)
model.low <- glm(low ~ age*lwt*smoke, binomial, data=birthwt)
summary(model.low)
summary(step(model.low))
View(birthwt)
coop
coop = coop
View(coop)
table(coop$Lab)
tapply(SBR3$head, SBR3$delivery, hist, shapiro.test)
bartlett.test(SBR3$head ~ SBR3$delivery) # variances are different
tapply(coop$Conc, coop$Lab, hist)
l1 = subset(coop, Lab=="L1")
hist(l1$Conc)
tapply(coop$Conc, coop$Lab, hist)
hist(l1$Conc)
tapply(coop$Conc, coop$Lab, hist)
l6 = subset(coop, Lab=="L6")
hist(l6$Conc)
tapply(coop$Conc, coop$Lab, shapiro.test)
table(coop)
summary(coop)
hist(coop$Conc, coop$Lab)
kruskal.test(coop$Conc ~ coop$Lab)
pairwise.wilcox.test(coop$Conc, coop$Lab)
tapply(coop$Conc, coop$Lab, shapiro.test)
26+29+17
bacteria
124+96
table(bacteria$y, bacteria$trt)
12+84
18+44
13+49
96+62+62
prop.test(c(84,44,49),c(96,62,62))
12+64
12+84
18+44
29+62
49+62
13+49
prop.test(c(84,44,49),c(96,62,62))
summary(bacteria$ap)
prop.test(124, 220, 0.5)
prop.test(c(84,44,49),c(96,62,62))
table(bacteria$y, bacteria$trt)
prop.test(c(84,44,49),c(96,62,62))
anorexia
table(anorexia$Treat)
cont = subset(anorexia, Treat=="Cont")
cbt = subset(anorexia, Treat=="CBT")
ft = subset(anorexia, Treat=="FT")
wilcox.test(cont$Postwt, cont$Prewt, paired=T, conf.int=T)
wilcox.test(cbt$Postwt, cbt$Prewt, paired=T, conf.int=T)
wilcox.test(ft$Postwt, ft$Prewt, paired=T, conf.int=T)
birthreg <- lm(birthwt$bwt ~ birthwt$lwt)
summary(birthreg)
plot(birthwt$bwt ~ birthwt$lwt)
abline(birthreg)
evans
load("C:/Users/12927/Desktop/RLectures/10LogisticReg/Workspace2.RData")
View(evans)
model.low <- glm(low ~ age*lwt*smoke, binomial, data=birthwt)
summary(model.low)
summary(step(model.low))
coop = coop
table(coop$Lab)
tapply(coop$Conc, coop$Lab, hist)
tapply(coop$Conc, coop$Lab, shapiro.test)
kruskal.test(coop$Conc ~ coop$Lab)
pairwise.wilcox.test(coop$Conc, coop$Lab)
library(MASS)
bacteria
